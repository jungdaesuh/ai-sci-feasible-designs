5
2
0
2

n
u
J

4
2

]

G
L
.
s
c
[

1
v
3
8
5
9
1
.
6
0
5
2
:
v
i
X
r
a

ConStellaration: A dataset of QI-like stellarator
plasma boundaries and optimization benchmarks

Santiago A. Cadena

Andrea Merlo

Emanuel Laude

Alexander Bauer

Atul Agrawal Maria Pascu MarÄ³a Savtchouk

Enrico Guiraud

Lukas Bonauer

Stuart Hudson Markus Kaiser

Proxima Fusion
{scadena, amerlo}@proximafusion.com

Abstract

Stellarators are magnetic confinement devices under active development to deliver
steady-state carbon-free fusion energy. Their design involves a high-dimensional,
constrained optimization problem that requires expensive physics simulations and
significant domain expertise. Recent advances in plasma physics and open-source
tools have made stellarator optimization more accessible. However, broader com-
munity progress is currently bottlenecked by the lack of standardized optimization
problems with strong baselines and datasets that enable data-driven approaches,
particularly for quasi-isodynamic (QI) stellarator configurations, considered as a
promising path to commercial fusion due to their inherent resilience to current-
driven disruptions. Here, we release an open dataset of diverse QI-like stellarator
plasma boundary shapes, paired with their ideal magnetohydrodynamic (MHD)
equilibria and performance metrics. We generated this dataset by sampling a
variety of QI fields and optimizing corresponding stellarator plasma boundaries.
We introduce three optimization benchmarks of increasing complexity: (1) a single-
objective geometric optimization problem, (2) a â€œsimple-to-build" QI stellarator,
and (3) a multi-objective ideal-MHD stable QI stellarator that investigates trade-offs
between compactness and coil simplicity. For every benchmark, we provide refer-
ence code, evaluation scripts, and strong baselines based on classical optimization
techniques. Finally, we show how learned models trained on our dataset can effi-
ciently generate novel, feasible configurations without querying expensive physics
oracles. By openly releasing the dataset (https://huggingface.co/datasets/
proxima-fusion/constellaration) along with benchmark problems and base-
lines (https://github.com/proximafusion/constellaration), we aim to
lower the entry barrier for optimization and machine learning researchers to engage
in stellarator design and to accelerate cross-disciplinary progress toward bringing
fusion energy to the grid.

1

Introduction

Fusion energy promises virtually limitless, carbon-free power by harness-
ing the same process that powers the sun. Magnetic confinement fusion
approaches trap a fully ionized gas (plasma) within magnetic fields to
sustain the conditions required for fusion. Among these, stellarators
confine the plasma solely through external coils, which produce three-
dimensional, twisted magnetic flux surfaces (Figure 1). Unlike tokamaks,
stellarators do not rely on large internal plasma currents, thereby avoiding
associated instabilities [1, 2]. However, this advantage comes with a

Figure 1: Examples of
diverse stellarator plasma
boundaries.

Preprint. Under review.

trade-off. Designing stellarators involves a significantly more complex parameter space: shaping
the three-dimensional plasma boundary to satisfy multiple physics and engineering constraints is a
high-dimensional, constrained, optimization problem.

Stellarator design has been mainly approached as a two-stage process [3]. In stage one, the magnetic
field that confines the plasma is optimized; in stage two, electromagnetic coils are designed to
reproduce this field. Stage one, the focus of this work, optimizes a three-dimensional surface that
defines the boundary condition for the plasma equilibrium magnetic field. The surface is commonly
parameterized by a truncated Fourier series in cylindrical coordinates (Figure 2, left). A solution
to the ideal-magnetohydrodynamics (MHD) equations is then computed to determine the magnetic
field inside the plasma [4]. VMEC [5] and its recent C++ re-implementation [6] are classical physics
codes that compute a solution to the ideal-MHD model (Figure 2). From the MHD solution, we
can compute multiple magnetic field properties, e.g. the rotational transform, that we can iteratively
optimize to target a desired value in an outer optimization loop by updating the plasma boundary.

Figure 2: A plasma boundary is defined by the coefficients ğ‘…ğ‘šğ‘› and ğ‘ğ‘šğ‘› of a truncated Fourier
series in cylindrical coordinates, parametrized by the lab-frame poloidal angle ğœƒ and toroidal angle
ğœ™. This boundary is passed to the VMEC++ code [5, 6] to compute an ideal-MHD equilibrium. In
this example, the configuration is stellarator symmetric, meaning that ğ‘…(ğœƒ, ğœ™) = ğ‘…(âˆ’ğœƒ, âˆ’ğœ™) and
ğ‘ (ğœƒ, ğœ™) = âˆ’ ğ‘ (âˆ’ğœƒ, âˆ’ğœ™), and the number of repeated field periods (ğ‘fp) is four. The ideal-MHD
equilibrium defines the magnetic field throughout the plasma volume, comprising nested magnetic
flux surfaces on which magnetic field lines (depicted in white) lie. We can then compute various
metrics of interest from the equilibrium field.

Unlike tokamaks, classical or unoptimized stellarators lack toroidal symmetry and inherently suffer
from poor confinement of high-energy particles: such fusion-born particles often escape the plasma
volume, striking plasma facing components before depositing their energy back into the plasma.
This prevents a self-sustained fusion process. The root cause lies in the behavior of particles
trapped in poloidal, toroidal, or helical magnetic wells, which fail to sample the entire magnetic
flux surface, experiencing a net radial drift that leads to gradually loosing confinement. These
challenges are a direct consequence of the non-axisymmetric magnetic geometry of stellarators.
A particularly effective strategy to suppress these drifts is to optimize stellarators imposing the
condition of omnigeneity [7, 8], which requires only that the average radial drift of trapped particles
vanishes. Among omnigenous fields, quasi-isodynamicity (QI) fields have poloidally closed contours
of the magnetic field strength [9â€“11], which results in a vanishing net plasma toroidal current. The
advantages of even approximate QI fields have been validated in laboratory experiments, most notably
in the Wendelstein-7X (W7-X) stellarator [12]. These compelling benefits have made the QI symmetry
a target in the design of next-generation stellarator-based fusion power plants [13, 14].

Major advances in open-source software frameworks for stellarator design have been presented in
recent years. For example, SIMSOPT [15] provides high-level interfaces to link plasma equilibrium
solvers such as VMEC [5] or SPEC [16] with numerical optimizers. Moreover, tools like DESC [17]

2

have leveraged end-to-end automatic differentiation [18] to simultaneously compute MHD equilibria
and target desired properties. However, these tools still present a high entry barrier for practitioners
in the optimization and machine learning communities, as they require substantial domain knowledge
to make meaningful contributions.

Although significant progress has been made in defining what to target in stellarator design, there
remains a lack of standardized benchmark problems and evaluation protocols to address stage one
optimization. This contrasts to other areas of machine learning, where well-defined challenges have
driven rapid and measurable progress [19]. Establishing such benchmarks in stellarator research
would offer significant value by enabling systematic comparisons of optimization methods across
a range of problem formulations. For instance, different representations (parameterizations) of the
plasma boundary may vary in their effectiveness: some may better avoid local minima, while others
may facilitate faster or more reliable convergence to feasible solutions. Our contributions are as
follows.

â€¢ We release a diverse dataset of about 158,000 QI-like stellarator plasma boundaries with their
associated ideal-MHD equilibria (in vacuum) computed with VMEC++ [6] and corresponding
figures of merit.

â€¢ We propose three optimization problems of varying complexity and kind, and release

associated code.

â€¢ We provide a set of baselines for these optimization problems using classical optimization

approaches.

â€¢ We show that models trained on our dataset can generate novel configurations that satisfy

optimization constraints, even when only a handful of training examples do.

1.1 Related work

Stellarator datasets. Beyond works releasing a small set of plasma configurations [20, 21], large-
scale datasets have focused on stellarators with quasi-axisymmetry (QA) or quasi-helical symmetry
(QH) [22â€“24], but not QI. These studies rely on an expansion about the magnetic axis [25â€“30] (the
field line representing the innermost flux surface) that reduces the 3D MHD equations into a 1D
ordinary differential equation, which is much faster to solve. Landreman [22] sampled âˆ¼ 500ğ‘˜
QA and QH configurations, while Giuliani [23], Giuliani et al. [24] sampled âˆ¼ 370ğ‘˜ QA and QH
configurations as part of the QUASR dataset 1. To the best of our knowledge, none of these datasets
include publicly available computed ideal-MHD equilibria.

Stellarator optimization benchmarks. While several studies have proposed sets of optimization
problems to test optimization strategies or shape parameterizations (e.g.[31]), and others have surveyed
optimization approaches [32], there are no standardized benchmarks for stellarator optimization.

1.2 Background

In Boozer coordinates [33] (Figure 3), magnetic field strength contours of QI fields exhibit three
characteristic properties: (i) the contours close poloidally, appearing as vertically closed loops in a
Boozer plot; (ii) the magnetic field strength maxima align along straight vertical lines; and (iii) the
arc length between points of equal magnetic field strength along a field line depends only on the flux
surface (i.e., it is invariant across field lines) [11]. The targets in Figure 4 and Figure 5 are examples
of precise QI fields.

2 A diverse dataset of QI-like plasma boundaries and ideal-MHD equilibria

Directly sampling the Fourier coefficients representing the plasma boundary (Figure 2) would very
rarely lead to good (or even valid) stellarator fields [34]. To generate a large and diverse dataset of
stellarator configurations that are approximately QI, we aim to sample diverse QI fields and other
geometrical properties, and search for plasma boundaries that produce those target fields. These target
generative factors include the aspect ratio ğ´ (the ratio between the major and minor toroidal radii:

1https://quasr.flatironinstitute.org

3

Figure 3: Visualization of the iso-contours of the magnetic field strength ğµ and a few magnetic field
lines (black). In the Boozer coordinate system [33], the original poloidal and toroidal angles are
transformed into Boozer angles ğœƒ ğµ and ğœ™ğµ, respectively, to straighten the magnetic field lines (black).

ğ‘…0/ğ‘), the edge rotational transform ğœ„edge (how far a field line moves around the â€œshortâ€ (poloidal)
way along the torus each time it goes once around the â€œlongâ€ (toroidal) way), the mirror ratio Î”edge
(defined as (ğµmax âˆ’ ğµmin)/(ğµmax + ğµmin)), and the maximum elongation ğœ–max (the largest cross-section
elongation across toroidal angles [11]).

For a given target QI field and set of properties, we generated surfaces either through physics-informed
heuristics (Section 3 of Goodman et al. [11]), fast near-axis expansion models [29, 35] (using pyQSC
2), or through stage-one optimization runs. We passed all resulting surfaces to our forward model
running VMEC++ at high fidelity (Section 3) to obtain ideal-MHD equilibria and metrics of interest
(Figure 2). All configurations are limited to poloidal and toroidal mode numbers of at most four.
Assuming stellarator symmetry, ğ‘…ğ‘š,ğ‘› = 0; ğ‘š = 0, ğ‘› < 0 and ğ‘ğ‘š,ğ‘› = 0; ğ‘š = 0, ğ‘› â‰¤ 0, and fixing the
major radius ğ‘…0,0 = 1, the total number of degrees of freedom is 80 (Figure 2, left).

Sampling targets. To sample diverse QI fields, we used the parameterization for an omnigenous
field from Dudt et al. [8], imposing stellarator symmetry (Appendix A.1). Notably, our fields span a
diverse range of magnetic well shapes and show variation in how these wells are stretched along field
lines (Figure 4). The other target properties were drawn from a uniform distribution spanning a range
of sensible values (Table 6).

Figure 4: Four optimized samples from our dataset with 1, 2, 4, and 5 field periods. A finite
computational budget for each sample generation leads to an approximate QI field at the plasma
boundary. All field plots share the same color bar and the boundary cross-section labels correspond
to those in Figure 2.

Optimization. We implemented stage-one optimization approaches seeded with heuristic or near-
axis expansion models using DESC or VMEC++ -based frameworks and varying objective settings
(Appendix A.2). Multiple optimization approaches with finite budget increased diversity in the
resulting boundaries, even for the same set of target field and properties (Figure 5). Each DESC run

2https://github.com/rogeriojorge/pyQIC

4

took three minutes on average on a 32 vCPU 128GB RAM machine, while each VMEC++ run took
around one hour on average on a 32 vCPU 32GB RAM machine.

Results. We began by sampling 100k target sets. From this pool, we generated 30k and 49k plasma
boundary candidates using our heuristic and near-axis-expansion models, respectively. We then
applied the DESC optimizer twice to each targetâ€“once per initialization strategyâ€“yielding an additional
88k optimized boundaries. A subset of 15k targets was also optimized with VMEC++ in the loop,
seeded by rotating ellipses. Altogether, this produced roughly 182k candidate configurations, and we
evaluated equilibria and metrics with the high-fidelity forward model on 158k of them without errors.
Among these successful cases, 15k, 20k, 68k, 27k, and 28k configurations have 1, 2, 3, 4, and 5 field
periods, respectively. Our resulting dataset spans a broad range of target metrics (Fig. 6, left) and
reveals strong correlations between prescribed targets and the achieved values (Figure 6, right).

Figure 5: Diverse
plasma configurations
obtained for the same
targets. Optimization
methods vary in initial-
ization strategy, frame-
work,
and settings.
While some runs fa-
vor matching the tar-
get QI field and mirror
ratio, other runs better
match the remaining
target properties.

Figure 6: Distribution of metrics and comparisons between targets and outcomes. Pair plots show
only optimized configurations. Black lines represent the identity. ğ´, ğœ–ğ‘šğ‘ğ‘¥, and Î”ğ‘’ğ‘‘ğ‘”ğ‘’ were used as
upper-bound constraints during optimization, while the rotational transform was enforced as equality
constraint.

3 Optimization benchmark

Stellarator design can be naturally formulated as a multi-objective constrained optimization prob-
lem [32]. The objectives and constraints arise from both engineering and economic considerations
(e.g., limiting the aspect ratio to achieve a compact device) as well as physics-based requirements (e.g.,
ensuring a stable MHD plasma). The design process involves translating stakeholder expectations into

5

a consistent set of feasible requirements, and navigating the trade-offs among conflicting objectives in
a manner that aligns with the overarching design goals.

We introduce three prototypical stellarator design tasks with increasing complexity each involving
(1) Geometric, (2) Simple-to-Build QI, and (3)
different subsets of design metrics (Table 1):
MHD-stable QI, detailed in Table 2.

Forward Model We leverage VMEC++ [6] to compute vacuum 3D ideal-MHD equilibria, scaled
to ğ‘…0 = 1 m, ğµ0 â‰ƒ 1 T. Each vacuum equilibrium is fully defined by a single flux-surface mapping
Î£Î˜ : (ğœƒ, ğœ‘)
â†¦âˆ’â†’ (ğ‘…, ğœ™, ğ‘), where ğœƒ and ğœ‘ are generic poloidal and toroidal angles, respectively,
and Î˜ denotes the set of surface parameters, and (ğ‘…, ğœ™, ğ‘) are cylindrical coordinates. In VMEC++ ,
the truncated Fourier series presented in Figure 2 is used for Î£Î˜. However, for the purpose of these
optimization benchmark problems, we make no assumptions about the functional form of Î£Î˜. All
optimization problems have the form:

min
Î˜

( ğ‘“1 (Î˜), ğ‘“2(Î˜), . . .)
ğ‘ğ‘– (Î˜) â‰¤ ğ‘âˆ—

ğ‘– , âˆ€ğ‘– ,

subject to

(1)

where ğ‘“ğ‘– : Rğ· â†’ R are objective functions, ğ‘ğ‘– : Rğ· â†’ R are constraint functions, and ğ‘âˆ—
ğ‘– are
constraint targets. Each objective and constraint depends directly on the magnetic field, which in turn
is determined by the surface mapping that defines the boundary condition of the ideal-MHD model.

min
Î˜

(b) Simple-to-build QI

(a) Geometric problem
ğœ–max
s.t. ğ´ â‰¤ ğ´âˆ—,
Â¯ğ›¿ â‰¤ Â¯ğ›¿âˆ—,
Ëœğœ„ â‰¥ Ëœğœ„âˆ—.

(cid:101)ğ¿ âˆ‡ğµ
Ëœğœ„ â‰¥ Ëœğœ„âˆ—, QI â‰¤ QIâˆ—
Î” â‰¤ Î”âˆ—, ğ´ â‰¤ ğ´âˆ—
ğœ–max â‰¤ ğœ– âˆ—
Table 2: Constrained optimization problem formulations. See Table 1 for semantic associations to the
symbols. All metrics are a function of the boundary

(c) MHD-stable QI
(cid:0)âˆ’(cid:101)ğ¿ âˆ‡ğµ, ğ´(cid:1)
Ëœğœ„ â‰¥ Ëœğœ„âˆ—, QI â‰¤ QIâˆ—
Î” â‰¤ Î”âˆ—, ğ‘ŠMHD â‰¥ 0
âŸ¨ğœ’âˆ‡ğ‘Ÿ âŸ© â‰¤ âŸ¨ğœ’âˆ‡ğ‘Ÿ âŸ©âˆ—

min
Î˜
s.t.

min
Î˜
s.t.

max

3.1 Problem 1: Geometric

To onboard contributors to stel-
larator optimization, we propose
an intuitive, purely geometric
problem (Table 2) where we look
for stellarators that minimize the
maximum elongation ğœ–ğ‘šğ‘ğ‘¥ for
a given aspect ratio ğ´, edge
rotational transform Ëœğœ„, and av-
erage triangularity Â¯ğ›¿.
Â¯ğ›¿ aver-
ages the triangularity between the
two stellarator-symmetric cross-
sections (ğœ™ = 0 and ğœ™ = ğœ‹/ğ‘fp),
and Ëœğœ„ is the edge rotational transform per field period.

Metric
minimum normalized magnetic gradient scale length
edge rotational transform over number of field periods
aspect ratio
max elongation
edge magnetic mirror ratio
quasi isodynamicity residual
vacuum well
flux compression in regions of bad curvature
average triangularity

Table 1: Equilibrium field metrics and their acronyms.

Acronym
(cid:101)ğ¿âˆ‡B
Ëœğœ„
ğ´
ğœ–max
Î”
QI
ğ‘Šğ‘€ ğ» ğ·
âŸ¨ğœ’âˆ‡ğ‘Ÿ âŸ©
Â¯ğ›¿

3.2 Problem 2: Single-objective simple-to-build QI stellarator

Stellarators are notoriously challenging to construct due to their inherently three-dimensional magnetic
geometry. Optimized designs like W7-X demand millimeter coil tolerances [36]. Moreover, the
development and assembly of such devices can run into cost and schedule overruns driven by
manufacturing complexity, potentially leading to the cancellation of entire projects as it was the
case for the NCSX stellarator [37, 38]. This raises a key question: Can optimized QI stellarators be
realized using simpler, easier-to-manufacture coils?

In a fusion reactor, the spatial region between the plasma and coils must accommodate a divertor,
first wall (plasma-facing material components), neutron shielding, tritium-breeding blanket, and

6

magnets structural support. These layers, together with the magnet superconducting technologies
(e.g., low-temperature superconductors (LTS) or high-temperature superconductors (HTS)), impose
geometric and engineering constraints on coil design. The feasibility of a stellarator configuration
depends not only on plasma performance but also on how easily the required magnetic fields can be
generated using manufacturable coils.

Not all magnetic fields are equally coil-friendly. We colloquially refer to coil simplicity as the ease
with which modular coils can be placed and shaped to produce the desired field. For example, surfaces
with high coil simplicity allow coils to be located further from the plasma and require lower curvature
and fewer tight bends. We quantify coil simplicity using the normalized magnetic field gradient scale
length on the plasma boundary, following Kappel et al. [39]. This metric has proven effective in
guiding optimization towards configurations with simpler, more feasible coil designs [13, 14].

Historically, QI stellarators have required particularly complex coil geometries compared to other
quasi-symmetric configurations [40â€“43]. This benchmark problem challenges that assumption by
optimizing for precise QI fields that can be generated with simple coils.
Table 2 introduces the problem definition, where (cid:101)ğ¿ âˆ‡B is magnetic field gradient scale length [39]
normalized by ğ‘/ğ‘fp, QI = 1
ğ‘„ğ¼ dğœƒ dğœ™ quantifies deviation from a precise QI field follow-
4 ğœ‹2
ing Goodman et al. [11], and Î” is the magnetic mirror ratio at the plasma boundary. We normalize the
objective by ğ‘/ğ‘fp to ensure scale invariance across configurations with varying field period numbers.
Since a QI field is easier to achieve for large aspect ratio configurations, highly elongated flux surfaces,
and large mirror ratios [11], we explicitly control these quantities through inequality constraints.

âˆ« âˆ« ğ‘Ÿ 2

3.3 Problem 3: Multi-objective ideal-MHD stable QI stellarators

This optimization problem introduces two new critical constraints for reactor relevant stellarator
design: ideal-MHD plasma stability and mitigation of turbulent transport.

Despite the fact that QI configurations eliminate current-driven instabilities (â€œdisruptions") that often
affect tokamak designs, pressure-driven instabilities persist [9], thus limiting access to high fusion
power density regimes. To optimize for ideal-MHD stability, we adopt the vacuum magnetic well
ğ‘ŠMHD as a proxy [25, 44]
Turbulent transport, expected to be dominated by ion-temperature gradient (ITG) turbulence in QI
stellarators [12, 45, 46], limits the achievable fusion gain. Landreman et al. [47] demonstrated how
purely geometrical quantities correlate strongly with the turbulence heat flux. As a constraint, we
compute the â€œflux-surface compression in regions of bad curvature" given by ğœ’âˆ‡ğ‘Ÿ = H (B Ã— ğœ… Â·
âˆ‡ğ›¼) âˆ¥âˆ‡ğ‘Ÿ âˆ¥2
2 as a simple geometric proxy. Here H is the Heavyside step function, B Ã— ğœ… Â· âˆ‡ğ›¼ is
the curvature drift [48] , ğœ… is the magnetic field curvature, ğ›¼ is the field line label, and âˆ‡ğ‘Ÿ is the
flux compression. A positive curvature drift represents regions of bad curvature. This quantity is
evaluated on a single-flux surface at ğœŒ = ğ‘Ÿ/ğ‘ = 0.7.
In quasi-poloidal (QP) and QI stellarators, ğ¿ âˆ‡B âˆ ğ‘…0/ğ‘fp = ğ‘ ğ´/ğ‘fp 3. More compact devices (low ğ´)
reduce capital cost per unit output power [49, 50] but increase coil complexity (proxied by ğ¿ âˆ‡B). This
trade-off motivates a Pareto-optimal search [51] between coil simplicity and compactness. Table 2
introduces the problem definition, where âŸ¨Â·âŸ© denotes flux-surface averaging.

3.4 Evaluation metric

We release evaluation code that scores candidate plasma boundaries across benchmarks. Our
evaluation code requires the plasma boundaries to be represented by the truncated Fourier series in
cylindrical coordinates (see Figure 2).

Single-objective scoring For single-objective problems, we map each design point to a bounded
scalar score value ğ‘ (Î˜) given by:

ğ‘ (Î˜) =

(cid:26)â„(cid:0) ğ‘“ (Î˜)(cid:1)
0

if Ëœğ‘ğ‘– (Î˜) â‰¤ ğœ€, âˆ€ğ‘–,
otherwise,

(2)

3Assuming that the characteristic length scale of the magnetic field gradient satisfies ğ¿âˆ‡B âˆ ğ¿âˆ‡ğµ, and
considering a QP magnetic field where the magnetic field strength forms a single well, i.e., ğµ(ğœ‘) = ğµ0 cos(ğ‘fpğœ‘),
where ğœ‘ is a field-aligned coordinate.

7

where ğ‘“ (Î˜) is the objective value, â„ : R â†’ [0, 1] is a linear map that rescales objectives into the
[0, 1] interval (higher is better), Ëœğ‘ğ‘– = (ğ‘ğ‘– âˆ’ ğ‘âˆ—
ğ‘– is the ğ‘–-th normalized constraint violation, and ğœ€ is
a relative tolerance.

ğ‘– )/ğ‘âˆ—

Multi-objective scoring For multi-objective problems, we compute the hypervolume (HV) indica-
tor [52, 53] over feasible solutions (i.e., those with Ëœğ‘ğ‘– (Î˜) â‰¤ ğœ€, âˆ€ğ‘– ) using a fixed reference point in
objectives space.

4 Optimization baselines

We now provide baselines for the three optimization problems. For all experiments, we target
stellarators with three field periods and seed optimizations from rotating ellipse configurations. For
the single-objective case (problem 1 and 2), we benchmark three approaches: a) gradient-based (where
the gradient of the objective and constraint functions is approximated via forward finite-differences)
trust-region interior point constrained optimizer [54] (scipy-trust-constr); b) gradient-free
COBYQA [55] algorithm (scipy-COBYQA); and c) Augmented Lagrangian method (ALM) [56, 57]
with a non-Euclidean proximal regularization [58, 59] employing the NGOpt gradient-free meta-
algorithm from Nevergrad [60] (ALM-NGOpt), to solve the subproblem. Implementation specifics are
provided in the Appendix A.4.

Only ALM-NGOpt obtains feasible solutions, while both scipy-trust-constr and scipy-COBYQA
did not (Table 3 and 5). Consequently, our leaderboard (Table 5) reports results exclusively for
ALM-NGOpt. Figure 9 shows the optimized QI field and a representative coilset for the simple-to-build
problem.

The multi-objective problem is decomposed into multiple single-objective problems by treating the
aspect ratio as an inequality constraint. Using ALM-NGOpt, we found solutions for four of these
instances. A sparse Pareto front is provided in Figure 7.

Method

scipy-trust-constr
scipy-COBYQA
ALM-NGOpt

Simple-to-build

Geometric problem

Ëœğ¿âˆ‡ğµ â†‘
2.10âˆ—
14.4âˆ—
8.61

norm. constr. viol.
3.25âˆ—
2.04âˆ—
0.009

ğœ–max â†“
15.0âˆ—
1.27
1.27

norm. constr. viol.
0.301âˆ—
0.953
0.0002

Table 3: Comparison of baselines for the simple-to-build and the geometric problem. â†‘ means that
a quantity is maximized and â†“ means that a quantity is minimized. Final optimized boundaries for
which VMEC++ failed to converge at high fidelity (i.e., the fidelity with which we score a plamsa
boundary) are represented with âˆ—; for them, we report the objective and constraint values from a
lower fidelity equilibrium computation. scipy-trust-constr and scipy-COBYQA do not produce
feasible solutions. SciPy-based optimizers ran for âˆ¼ 40 hours on a machine with 4 vCPUs. ALM-NGOpt
ran on a 96 vCPU machine for 18 hours (geometric problem) and 34 hours (simple-to-build).

Figure 7: Pareto-front for
the multi-objective optimiza-
tion problem of MHD stable
QI stellarators obtained with
ALM-NGOpt.

ğ´ â†“

6.02
7.93
9.98
11.9

Ëœğ¿âˆ‡ğµ â†‘
2.98
5.60
8.45
11.1

norm. constr. viol.

0.104
0.00130
0.0
0.00210

Table 4: Objectives and constraint violations for ALM-NGOpt
on the multi-objective problem. Optimization was carried
out by solving a sequence of single-objective problems,
converting one objective into a constraint ğ´ â‰¤ ğ´âˆ— with
ğ´âˆ— âˆˆ {6, 8, 10, 12}. All instances were run on a 96-vCPU
machine for 15â€“24 h.

8

510ËœLâˆ‡B681012A0100000200000functioncalls1020ËœLâˆ‡B0100000200000functioncalls7.510.012.5A5 Generative modeling of feasible domains without access to the oracle

We present a method to generate feasible configurations using
learning-based models trained on the dataset, without relying
on a zero-order oracle (e.g., VMEC++ ) and with limited feasible
examples. We test whether this method can produce many valid
configurations to support downstream tasks like optimization.

Problem

Geometrical
Simple-to-build
MHD-stable

Score â†‘

0.969
0.431
130.0

We reduce the input dimensionality using Principal Component
Analysis (PCA) [61] to obtain a low-dimensional latent space.
In this space, Random Forest classifiers [62, 63] estimate the probability that a configuration is
feasible. Thresholding this probability (e.g., above 0.8) defines a soft feasible region. Within this
region, we fit a Gaussian mixture model (GMM) to capture the distribution of feasible points. Treating
the GMM as a prior and the classifier output as a quasi-likelihood, we use adaptive Markov chain
Monte Carlo (MCMC) [9, 64] to sample from the posterior. This allows us to generate several new
configurations that are likely to satisfy constraints without querying the oracle ( Figure 8). Details are
given in Appendix A.5 with full algorithmic details in Algorithm 2.

Table 5: ALM-NGOpt scores.

(a) geometric problem.

(b) Simple-to-build problem.

Figure 8: Posterior estimate of the feasible region in the first two PCA dimensions for two constraint-
relaxed problems. Blue crosses represent feasible configurations from the dataset. Green dots show
MCMC samples predicted to be feasible (classifier confidence â‰¥ 0.99), and red dots indicate predicted
infeasible samples. Green contours reflect the estimated density of feasible samples. Oracle validation
of randomly selected MCMC points are marked with green (feasible) and red (infeasible) crosses.
Both the geometric and simple-to-build problems are initially relaxed, with 41 and 52 feasible points
available in the dataset (out of âˆ¼ 160ğ‘˜).

When applied to relaxed versions of both the Geometric and Simple-to-build problems, our method
successfully identifies regions of design space in which sample points are judged feasible by both the
Random Forest classifier and the oracle model (i.e., using VMEC++ ) (Figure 8).

6 Discussion

We released a diverse dataset of ap-
proximately 158ğ‘˜ QI-like stellarator
plasma boundaries, associated metrics,
and ideal-MHD equilibria. Along-
side the dataset, we introduced a set
of stellarator optimization tasks with
strong classical baselines, designed
to facilitate rigorous and reproducible
evaluation of stellarator optimization
strategies. We further demonstrated a

Figure 9: Left: Optimized QI magnetic field contours at the
plasma boundary in Boozer coordinates for the simple-to-
build optimization problem. Right: A representative coilset
designed to reproduce the target magnetic field.

9

0.60.70.80.91.01.11.2PC10.60.81.01.21.41.61.82.0PC2MCMCSamplesVMECFeasiblePointsinDataset0.00.51.01.52.0Boozer toroidal angle Ï†B0123456Boozer poloidal angle Î¸B1.261.341.421.501.581.661.741.821.901.271.581.90|B|[T]data-driven generative approach that can produce feasible plasma configurations without querying
an expensive physics oracle. Nonetheless, several limitations remain. First, the degree of QI in the
dataset is inherently limited by the finite-budget, optimization-based sampling process used during
generation. Second, the dataset is limited to plasma boundaries; while these are usually the seeds in
stellarator design, a consistent design also requires many additional systems (e.g., electromagnetic
coils).

Acknowledgments

This work was independently funded by Proxima Fusion, and supported by the BMBF grant FUSKI
(FKZ: 13F1012A).

References

[1] John Wesson and David J Campbell. Tokamaks, volume 149. Oxford university press, 2011.

[2] TC Hender, JC Wesley, J Bialek, A Bondeson, AH Boozer, RJ Buttery, A Garofalo, TP Goodman,
RS Granetz, Y Gribov, et al. Mhd stability, operational limits and disruptions. Nuclear fusion,
47(6):S128, 2007.

[3] S. A. Henneberg, S. R. Hudson, D. PfefferlÃ©, and P. Helander. Combined plasmaâ€“coil
optimization algorithms. Journal of Plasma Physics, 87(2):905870226, 2021. doi: 10.1017/
S0022377821000271.

[4] Jeffrey P Freidberg. ideal MHD. Cambridge University Press, 2014.

[5] Steven P Hirshman and JC Whitson. Steepest descent moment method for three-dimensional
magnetohydrodynamic equilibria. Technical report, Oak Ridge National Lab.(ORNL), Oak
Ridge, TN (United States), 1983.

[6] Jonathan Schilling. The numerics of vmec++. arXiv preprint arXiv:2502.04374, 2025.

[7] John R Cary and Svetlana G Shasharina. Omnigenity and quasihelicity in helical plasma

confinement systems. Physics of Plasmas, 4(9):3323â€“3333, 1997.

[8] Daniel W Dudt, Alan G Goodman, Rory Conlin, Dario Panici, and Egemen Kolemen. Magnetic

fields with general omnigenity. Journal of Plasma Physics, 90(1):905900120, 2024.

[9] Per Helander and J NÃ¼hrenberg. Bootstrap current and neoclassical transport in quasi-isodynamic

stellarators. Plasma Physics and Controlled Fusion, 51(5):055004, 2009.

[10] Per Helander. Theory of plasma confinement in non-axisymmetric magnetic fields. Reports on

Progress in Physics, 77(8):087001, 2014.

[11] Alan G Goodman, K Camacho Mata, Sophia A Henneberg, Rogerio Jorge, Matt Landreman,
GG Plunk, HM Smith, RJJ Mackenbach, CD Beidler, and P Helander. Constructing precisely
quasi-isodynamic magnetic fields. Journal of Plasma Physics, 89(5):905890504, 2023.

[12] CD Beidler, HM Smith, A Alonso, T Andreeva, J Baldzuhn, MNA Beurskens, Matthias
Borchardt, SA Bozhenkov, Kai Jakob Brunner, Hannes Damm, et al. Demonstration of reduced
neoclassical energy transport in wendelstein 7-x. Nature, 596(7871):221â€“226, 2021.

[13] J Lion, J-C AnglÃ¨s, L Bonauer, A BaÃ±Ã³n Navarro, SA Cadena Ceron, R Davies, M Drevlak,
N Foppiani, J Geiger, A Goodman, et al. Stellaris: A high-field quasi-isodynamic stellarator for
a prototypical fusion power plant. Fusion Engineering and Design, 214:114868, 2025.

[14] CC Hegna, DT Anderson, EC Andrew, A Ayilaran, A Bader, TD Bohm, K Camacho Mata,
JM Canik, L Carbajal, A Cerfon, et al. The infinity two fusion pilot plant baseline plasma
physics design. Journal of Plasma Physics, pages 1â€“44, 2025.

[15] Matt Landreman, Bharat Medasani, Florian Wechsung, Andrew Giuliani, Rogerio Jorge, and
Caoxiang Zhu. Simsopt: a flexible framework for stellarator optimization. Journal of Open
Source Software, 6(65):3525, 2021.

10

[16] S. R. Hudson, R. L. Dewar, G. Dennis, M. J. Hole, M. McGann, G. von Nessi, and S. Lazerson.
Computation of multi-region relaxed magnetohydrodynamic equilibria. Physics of Plasmas, 19
(11):112502, 11 2012. ISSN 1070-664X. doi: 10.1063/1.4765691. URL https://doi.org/
10.1063/1.4765691.

[17] DW Dudt and E Kolemen. Desc: a stellarator equilibrium solver. Physics of Plasmas, 27(10),

2020.

[18] Mathieu Blondel and Vincent Roulet. The Elements of Differentiable Programming, March

2024. URL http://arxiv.org/abs/2403.14606. arXiv:2403.14606 [cs].

[19] Moritz Hardt. The emerging science of machine learning benchmarks. Online at https:

//mlbenchmarks.org, 2025. Manuscript.

[20] Richard Nies, Elizabeth J Paul, Dario Panici, Stuart R Hudson, and Amitava Bhattacharjee.
Exploration of the parameter space of quasisymmetric stellarator vacuum fields through adjoint
optimisation. Journal of Plasma Physics, 90(6):905900620, 2024.

[21] Stefan Buller, Matt Landreman, John Kappel, and Rahul Gaur. A family of quasi-axisymmetric
stellarators with varied rotational transform. Journal of Plasma Physics, 91(1):E18, 2025.

[22] Matt Landreman. Mapping the space of quasisymmetric stellarators using optimized near-axis

expansion. Journal of Plasma Physics, 88(6):905880616, 2022.

[23] Andrew Giuliani. Direct stellarator coil design using global optimization: application to a
comprehensive exploration of quasi-axisymmetric devices. Journal of Plasma Physics, 90(3):
905900303, 2024.

[24] Andrew Giuliani, Eduardo RodrÃ­guez, and Marina Spivak. A comprehensive exploration of
quasisymmetric stellarators and their coil sets. arXiv preprint arXiv:2409.04826, 2024.

[25] Claude Mercier. Equilibrium and stability of a toroidal magnetohydrodynamic system in the

neighbourhood of a magnetic axis. Nuclear Fusion, 4(3):213, 1964.

[26] DA Garren and Allen H Boozer. Existence of quasihelically symmetric stellarators. Physics of

Fluids B, 3(10):2822â€“2834, 1991.

[27] David Alan Garren and AH Boozer. Magnetic field strength of toroidal plasma equilibria.

Physics of Fluids B: Plasma Physics, 3(10):2805â€“2821, 1991.

[28] Matt Landreman. Optimized quasisymmetric stellarators are consistent with the garrenâ€“boozer

construction. Plasma Physics and Controlled Fusion, 61(7):075001, 2019.

[29] Matt Landreman and Wrick Sengupta. Constructing stellarators with quasisymmetry to high

order. Journal of Plasma Physics, 85(6):815850601, 2019.

[30] Eduardo RodrÃ­guez, Wrick Sengupta, and Amitava Bhattacharjee. Constructing the space of
quasisymmetric stellarators through near-axis expansion. Plasma Physics and Controlled Fusion,
65(9):095004, 2023.

[31] Sophia A Henneberg, Per Helander, and Michael Drevlak. Representing the boundary of

stellarator plasmas. Journal of Plasma Physics, 87(5):905870503, 2021.

[32] Rory Conlin, Patrick Kim, Daniel W Dudt, Dario Panici, and Egemen Kolemen. Stellarator

optimization with constraints. Journal of Plasma Physics, 90(5):905900501, 2024.

[33] Allen H Boozer. Plasma equilibrium with rational magnetic surfaces. Technical report, Princeton

Plasma Physics Lab.(PPPL), Princeton, NJ (United States), 1981.

[34] P Curvo, DR Ferreira, and R Jorge. Using deep learning to design high aspect ratio fusion

devices. Journal of Plasma Physics, 91(1):E38, 2025.

[35] R Jorge, W Sengupta, and M Landreman. Near-axis expansion of stellarator equilibrium at
arbitrary order in the distance to the axis. Journal of Plasma Physics, 86(1):905860106, 2020.

11

[36] Thomas Rummel, Konrad Risse, Holger Viebke, Torsten Braeuer, and Johann Kisslinger.
Accuracy of the construction of the superconducting coils for wendelstein 7-x. IEEE transactions
on applied superconductivity, 14(2):1394â€“1398, 2004.

[37] National compact stellarator experiment (ncsx) project closeout report. Technical report,
Princeton Plasma Physics Laboratory, August 2009. URL https://ncsx.pppl.gov/NCSX_
Engineering/CloseOut_Documentation/Closeout_Report_20080910.pdf. Prepared
for the U.S. Department of Energy Office of Science.

[38] GH Neilson, CO Gruber, Jeffrey H Harris, DJ Rej, RT Simmons, and RL Strykowsky. Lessons
learned in risk management on ncsx. IEEE transactions on plasma science, 38(3):320â€“327,
2010.

[39] John Kappel, Matt Landreman, and Dhairya Malhotra. The magnetic gradient scale length
explains why certain plasmas require close external magnetic coils. Plasma Physics and
Controlled Fusion, 66(2):025018, 2024.

[40] Haifeng Liu, Akihiro Shimizu, Mitsutaka Isobe, Shoichi Okamura, Shin Nishimura, Chihiro
Suzuki, Yuhong Xu, Xin Zhang, Bing Liu, Jie Huang, et al. Magnetic configuration and modular
coil design for the chinese first quasi-axisymmetric stellarator. Plasma and Fusion Research, 13:
3405067â€“3405067, 2018.

[41] Rogerio Jorge, GG Plunk, M Drevlak, M Landreman, J-F Lobsien, K Camacho Mata, and
P Helander. A single-field-period quasi-isodynamic stellarator. Journal of Plasma Physics, 88
(5):175880504, 2022.

[42] Florian Wechsung, Matt Landreman, Andrew Giuliani, Antoine Cerfon, and Georg Stadler.
Precise stellarator quasi-symmetry can be achieved with electromagnetic coils. Proceedings of
the National Academy of Sciences, 119(13):e2202084119, 2022.

[43] Alexander Vyacheslav Wiedman, Stefan Buller, and Matt Landreman. Coil optimization for
quasi-helically symmetric stellarator configurations. arXiv preprint arXiv:2311.16386, 2023.

[44] John M Greene. A brief review of magnetic wells. Comments on Plasma Physics and Controlled

Fusion, 17:389â€“402, 1997.

[45] Marc NA Beurskens, Sergey A Bozhenkov, O Ford, Pavlos Xanthopoulos, Alessandro Zocco,
Yuri Turkin, A Alonso, Craig Beidler, I Calvo, Daniel Carralero, et al. Ion temperature clamping
in wendelstein 7-x electron cyclotron heated plasmas. Nuclear Fusion, 61(11):116072, 2021.

[46] Alan G Goodman, Pavlos Xanthopoulos, Gabriel G Plunk, HÃ¥kan Smith, Carolin NÃ¼hrenberg,
Craig D Beidler, Sophia A Henneberg, Gareth Roberg-Clark, Michael Drevlak, and Per Helander.
Quasi-isodynamic stellarators with low turbulence as fusion reactor candidates. PRX Energy, 3
(2):023010, 2024.

[47] Matt Landreman, Jong Youl Choi, Caio Alves, Prasanna Balaprakash, R Michael Churchill, Rory
Conlin, and Gareth Roberg-Clark. How does ion temperature gradient turbulence depend on
magnetic geometry? insights from data and machine learning. arXiv preprint arXiv:2502.11657,
2025.

[48] GT Roberg-Clark, P Xanthopoulos, and GG Plunk. Reduction of electrostatic turbulence in
a quasi-helically symmetric stellarator via critical gradient optimization. Journal of Plasma
Physics, 90(3):175900301, 2024.

[49] WR Spears and JA Wesson. Scaling of tokamak reactor costs. Nuclear Fusion, 20(12):1525,

1980.

[50] JP Freidberg, FJ Mangiarotti, and J Minervini. Designing a tokamak fusion reactorâ€”how does

plasma physics fit in? Physics of Plasmas, 22(7), 2015.

[51] Joaquim RRA Martins and Andrew Ning. Engineering design optimization. Cambridge

University Press, 2021.

12

[52] Eckart Zitzler and Lothar Thiele. Multiobjective optimization using evolutionary algorithmsâ€”a
comparative case study. In International conference on parallel problem solving from nature,
pages 292â€“301. Springer, 1998.

[53] Miqing Li and Xin Yao. Quality evaluation of solution sets in multiobjective optimisation: A

survey. ACM Computing Surveys (CSUR), 52(2):1â€“38, 2019.

[54] Richard H Byrd, Mary E Hribar, and Jorge Nocedal. An interior point algorithm for large-scale

nonlinear programming. SIAM Journal on Optimization, 9(4):877â€“900, 1999.

[55] Tom M Ragonneau. Model-based derivative-free optimization methods and software. arXiv

preprint arXiv:2210.12018, 2022.

[56] Magnus R Hestenes. Multiplier and gradient methods. Journal of optimization theory and

applications, 4(5):303â€“320, 1969.

[57] Michael JD Powell. A method for nonlinear constraints in minimization problems. Optimization,

pages 283â€“298, 1969.

[58] R Tyrrell Rockafellar. Augmented lagrangians and applications of the proximal point algorithm

in convex programming. Mathematics of operations research, 1(2):97â€“116, 1976.

[59] Emanuel Laude and Panagiotis Patrinos. Anisotropic proximal point algorithm. arXiv preprint

arXiv:2312.09834, 2023.

[60] J. Rapin and O. Teytaud. Nevergrad - A gradient-free optimization platform. https://GitHub.

com/FacebookResearch/Nevergrad, 2018.

[61] HervÃ© Abdi and Lynne J Williams. Principal component analysis. Wiley interdisciplinary

reviews: computational statistics, 2(4):433â€“459, 2010.

[62] Christopher M Bishop and Nasser M Nasrabadi. Pattern recognition and machine learning,

volume 4. Springer, 2006.

[63] Kevin P Murphy. Probabilistic machine learning: Advanced topics. MIT press, 2023.

[64] Russel E Caflisch. Monte Carlo and quasi-Monte Carlo methods. Acta numerica, 7:1â€“49, 1998.

[65] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blondel,
P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cournapeau, M. Brucher,
M. Perrot, and E. Duchesnay. Scikit-learn: Machine learning in Python. Journal of Machine
Learning Research, 12:2825â€“2830, 2011.

[66] W Keith Hastings. Monte Carlo sampling methods using markov chains and their applications.

1970.

[67] Heikki Haario, Eero Saksman, and Johanna Tamminen. An adaptive metropolis algorithm.

Bernoulli, pages 223â€“242, 2001.

13

A Technical Appendices

A.1 Data generation: sampling omnigenous poloidal fields

We leverage the parameterization of an omnigenous poloidal field from Dudt et al. [8] in which the
1D magnetic well on each flux surface is represented by a spline on the interval [âˆ’ğœ‹/2, ğœ‹/2]. The
well is symmetric about its minimum, so it can simply be parameterized between ğµğ‘šğ‘–ğ‘› and ğµğ‘šğ‘ğ‘¥.
The full omnigenous field is then built by â€œmorphing" this one-dimensional well across magnetic
field lines via a computational coordinate â„, which is expanded in a Chebyshev basis (radial index
ğ‘™) and Fourier bases (poloidal index ğ‘š, toroidal index ğ‘›) with coefficients ğ‘¥ğ‘™ğ‘šğ‘› [8]. In practice, we
generate new omnigenous-poloidal fields by sampling both the spline knots and ğ‘¥ğ‘™ğ‘šğ‘› coefficients. To
enforce stellarator symmetry (invariance under simultaneous flips of the poloidal and toroidal Boozer
angles), we set the coefficients of the odd terms of the Fourier basis along the toroidal direction to
zero, namely ğ‘¥ğ‘™ğ‘šğ‘› = 0 âˆ€ğ‘› >= 0.

To produce a variety of monotonically increasing 1D well shapes, we draw knot positions from
Beta(ğ›¼, ğ›½) cumulative distribution functions and then rescaled them to lie between ğµğ‘šğ‘–ğ‘› and ğµğ‘šğ‘ğ‘¥.
Finally, we fix the mean magnetic field at 1 T and sample the mirror ratio Î” to determine the pair
(ğµğ‘šğ‘–ğ‘›, ğµğ‘šğ‘ğ‘¥).

The ranges from which we sample these parameters can be found in Table 6.

Parameter Min Max
ğ‘fp
Ëœğœ„
ğ´
ğœ–max
ğ›¼Beta
ğ›½Beta
Î”edge

5
0.3
12.0
7.0
6.0
6.0
0.4

1
0.1
4.0
4.0
2.0
2.0
0.1

Table 6: Ranges of sampling parameters with both minimum and maximum values.

A.2 Data generation: stage one optimizations using DESC [17]

Given a set of target quantities:

ğ‘‡ = (cid:0)ğœ„âˆ—, ğ´âˆ—, ğ¸ âˆ—, Oâˆ—(cid:1)

where

â€¢ ğœ„âˆ— is the desired edge rotational transform,
â€¢ ğ´âˆ— is the target aspect ratio,
â€¢ ğ¸ âˆ— is the maximum elongation,
â€¢ Oâˆ— is the target omnigenous field,

we ran numerical optimizations to find a toroidal boundary surface Î£ (parameterized in a Fourier-ğ‘…ğ‘
basis) that simultaneously matches these goals. Note that the mirror ratio Î” is defined within Oâˆ—.

A.2.1

Initial Guess Generation

An initial boundary Î£0 is generated either by

1. Heuristic QP model (Section III from Goodman et al. [11]): prescribing average major

radius ğ‘…0, aspect ratio ğ´âˆ—, elongation ğ¸ âˆ—, mirror ratio, torsion, and field periods; or

2. Near-Axis Expansion (NAE) using pyQSC 4: specifying ğ´âˆ—, ğ¸ âˆ—, ğœ„âˆ—, mirror ratio, field

periods, and mode cutoffs.

This yields a smooth Î£0 expressed in the FourierRZToroidalSurface format of DESC.

4https://github.com/rogeriojorge/pyQIC

14

A.2.2 Equilibrium Solve

Starting from Î£0, we form the DESC equilibrium object and solve the force balance

E (Î£) = Equilibrium(cid:0)Î¨, Î£, ğ‘€, ğ‘ (cid:1)

and solve the magnetostatic force-balance equations using

solve(force)
âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’â†’ Esol .

E

A.2.3 Objective Function

On the solved equilibrium Esol, we define individual objective terms:

ğ½ğ´(Î£) =

ğ‘…0 (Î£)
ğ‘(Î£)

,

ğ½ğ¸ (Î£) = max

ğœ‘

ğ‘(ğœ‘; Î£)
ğ‘(ğœ‘; Î£)

,

ğ½ ğœ„ (Î£) = ğœ„ [Esol],
JO (Î£) = O (cid:2)Esol, Oâˆ—(cid:3),

ğ‘“ ğ´ = ğ‘¤ ğ´ (cid:0)ğ½ğ´ âˆ’ ğ´âˆ—(cid:1) 2,

ğ‘“ğ¸ = ğ‘¤ğ¸ (cid:0)ğ½ğ¸ âˆ’ ğ¸ âˆ—(cid:1) 2,

ğ‘“ ğœ„ = ğ‘¤ ğœ„ (cid:0)ğ½ ğœ„ âˆ’ ğœ„âˆ—(cid:1) 2,
(cid:13)
ğ‘“O = ğ‘¤ O
(cid:13)JO

(cid:13)
(cid:13)

,

2
2

(3)

(4)

(5)

(6)

where ğ‘, ğ‘ are the minor/major half-axes of the cross-section, ğœ‘ is the toroidal angle, and the
omnigenous residual JO is computed by the DESC Omnigenity objective using the target field Oâˆ—.
The omnigenity contribution (cid:13)

(cid:13)JO

ğ‘ğœ‚
âˆ‘ï¸

(cid:13)
(cid:13)

2
2 is given by
ğ‘ğ›¼âˆ‘ï¸

ğ‘–=1

ğ‘—=1

ğ‘¤(ğœ‚ğ‘–) (cid:2)ğµeq(ğœŒ0, ğœ‚ğ‘–, ğ›¼ ğ‘— ) âˆ’ ğµâˆ— (ğœŒ0, ğœ‚ğ‘–, ğ›¼ ğ‘— )(cid:3) 2,

(cid:13)
(cid:13)JO

(cid:13)
2
2 =
(cid:13)

with the poloidal weight

ğ‘¤(ğœ‚) =

ğœ‚weight + 1
2

+

ğœ‚weight âˆ’ 1
2

cos ğœ‚

(cid:0)so ğ‘¤ â‰¡ 1 if ğœ‚weight = 1(cid:1),

where ğµeq is the field strength of the equilibrium in (ğœŒ, ğœ‚, ğ›¼) coordinates and ğµâˆ— is the perfectly-
omnigenous target field generated by OmnigenousField as in [8]. The residuals ğ‘Ÿğ‘– ğ‘— = âˆšï¸ğ‘¤(ğœ‚ğ‘–) (cid:0)ğµeq âˆ’
ğµâˆ—(cid:1)

ğ‘– ğ‘— are evaluated on the same (ğœ‚, ğ›¼)-grid used by the target field.

On a solved equilibrium Esol at a fixed flux surface ğœŒ = ğœŒ0, we assemble a least-squares objective
L (Î£) = ğ‘“ ğ´ + ğ‘“ğ¸ + ğ‘“ ğœ„ + ğ‘“O .

Internally, DESC invokes JAX to compute residuals, leveraging automatic differentiation to compute
gradients.

The objective is then wrapped in an augmented-Lagrangian least-squares optimizer (lsq-auglag)
[32] to minimize âˆ¥ğ‘Ÿ âˆ¥2

2 alongside the other terms.

A.2.4 Constraints

To enforce vacuum equilibrium and fix global invariants, the following constraints are imposed:

ğ‘…0,0 (Î£) = 1,
ğ‘— âˆ¥ (Î£) = 0,
ğ‘(Î£) = 0,
ğ½tor (Î£) = 0,
Î¨(Î£) = const.,

(FixBoundaryR)
(CurrentDensity)
(FixPressure)
(FixCurrent)
(FixPsi)

where each is implemented via the corresponding DESC linear-objective wrapper.

15

A.2.5 Nonlinear Optimization

We employ DESCâ€™s lsq-auglag optimizer [32] to solve

min
Î£

L (Î£)

s.t. all linear constraints,

using automatic differentiation and a trust-region least-squares augmented-Lagrangian scheme.
Iterations continue until convergence (up to 200 iterations by default), yielding the optimized
boundary Î£âˆ—.

exact
Our
constellaration.

implementation

is

available

at

https://github.com/proximafusion/

A.3 Stage one optimizations using VMEC++ [6] in the loop

We carried out optimizations using the NGOpt algorithm from the Nevergrad 5 library. To improve
convergence, we preconditioned the problem using a diagonal scaling matrix as detailed in Section
A.2.1. We parameterized the boundary with up to four poloidal and toroidal Fourier modes and
ran the optimization on a single machine equipped with 32 vCPUs and 32GB of RAM. Each run is
allocated a time budget of approximately 1 h.

The optimization minimizes the following objective function:

âˆ« 2 ğœ‹

âˆ« ğœ‹/ğ‘fp

ğ‘“ (Î˜) =

(ğµ(ğœƒ, ğœ™) âˆ’ ğµâˆ— (ğœƒ, ğœ™))2 ğ‘‘ğœƒ ğ‘‘ğœ™

ğµ(ğœƒ, ğœ™) âˆ’ ğµ(ğœƒ, ğœ™ = 0)

(cid:19) 2

ğ‘‘ğœƒ

max
ğœ™

(cid:19) 2

0
0
âˆ« 2 ğœ‹
(cid:18)

+

0
(cid:18) ğ´ âˆ’ ğ´âˆ—
ğ´âˆ—
(cid:32) ğœ„edge âˆ’ ğœ„âˆ—
ğœ„âˆ—
edge
(cid:18)

(cid:18)

max

0,

+

+

+

edge

ğœ–max âˆ’ ğœ– âˆ—
ğœ– âˆ—
max

max

(cid:19)(cid:19) 2

.

(cid:33) 2

(7)

where ğµ denotes the magnetic field strength from the ideal-MHD equilibrium in Boozer coordinates,
and ğµâˆ— represents the target omnigenous magnetic field strength. The quantities ğ´, ğœ„edge, and ğœ–max
correspond to the aspect ratio, edge rotational transform, and maximum elongation, respectively, with
asterisks denoting their target values. The additional target on the maxima of the magnetic field
strength guides the optimizer towards more QI fields.

In the optimization loop, we used VMEC++ within the forward model. To speed up the generation
of the optimized boundary, we run VMEC++ at a lower resolution than the one used to score plasma
boundaries in optimization benchmarks (e.g. reduced number of flux surfaces, higher required force
tolerance to converge).

Due to the constrained time budget, the optimization may not fully minimize the objective function
but added the desired diversity to the dataset.

Our
exact
constellaration.

implementation

A.4 Optimization baselines

is

available

at

https://github.com/proximafusion/

A.4.1

Implementation details and hyperparameters

In this section we provide implementation details for the optimization baseline. For the SciPy-based
optimizers, we use default parameters, and set the maximum number of iterations to a large value.

5https://github.com/facebookresearch/nevergrad

16

We implement a variant of the proximal ALM [58] where the quadratic proximal term is replaced by
a trust-region constraint. This can be seen as an instance of the anisotropic proximal ALM [59]. The
modification is essential for improving convergence when using evolutionary algorithms (such as
NGOpt), as it restricts the sampling of new candidate solutions to a region around the current iterate.

As the degrees of freedom Î˜ operate on different scale, we precondition the problem with a diagonal
matrix diag(Î›) where the entries Î› decay exponentially. We define the rescaled variables as
(cid:101)Î˜ := diag(Î›) âˆ’1Î˜ and Ëœğ‘“ ((cid:101)Î˜) := ğ‘“ (diag(Î›)(cid:101)Î˜) and Ëœğ‘ğ‘– ((cid:101)Î˜) := ğ‘ğ‘– (diag(Î›)(cid:101)Î˜). In addition, we apply a
base-10 logarithmic transformation to the QI constraint.
In each iteration, the algorithm alternates between primal and dual updates. For each constraint Ëœğ‘ğ‘–,
it tracks a penalty parameter ğœŒğ‘˜
ğ‘– . The complete algorithm is given
in Algorithm 1.

ğ‘– and a Lagrange multiplier ğ‘¦ğ‘˜

Algorithm 1 non-Euclidean proximal augmented Lagrangian method
Require: Î˜0 âˆˆ Rğ·, ğœŒ0 âˆˆ Rğ‘š
++, ğ‘¦0 âˆˆ Rğ‘š
1: for ğ‘˜ âˆˆ {0, 1, . . . , ğ‘ } do
Primal update
2:

+ , ğ›¿0 > 0, 0 < ğœ, ğ›¾ < 1, ğœ > 1 and ğ›¿min, ğœŒmax > 0

(cid:101)Î˜ğ‘˜+1 = arg min
(cid:101)Î˜âˆˆ ğµ((cid:101)Î˜ğ‘˜ , ğ›¿ğ‘˜ )

Ëœğ‘“ ((cid:101)Î˜) + 1
2

ğ‘š
âˆ‘ï¸

ğ‘–=1

(cid:16)

1
ğœŒğ‘˜
ğ‘–

max{0, ğ‘¦ğ‘˜

ğ‘– + ğœŒğ‘˜

ğ‘– Ëœğ‘ğ‘– ((cid:101)Î˜ğ‘˜)}2 âˆ’ (ğ‘¦ğ‘˜

ğ‘– )2(cid:17)

(8)

3:

dual update

ğ‘¦ğ‘˜+1
ğ‘–

4:

update penalty parameters

= max{0, ğ‘¦ğ‘˜

ğ‘– + ğœŒğ‘˜

ğ‘– Ëœğ‘ğ‘– ((cid:101)Î˜ğ‘˜+1)}

ğœŒğ‘˜+1
ğ‘–

=

(cid:26)ğœŒğ‘˜
ğ‘–
min{ğœŒmax, ğœğœŒğ‘˜
ğ‘– }

if Ëœğ‘ğ‘– ((cid:101)Î˜ğ‘˜+1) â‰¤ ğœ Ëœğ‘ğ‘– ((cid:101)Î˜ğ‘˜)
otherwise.

5:

decrease trust-region

6: end for

ğ›¿ğ‘˜+1 = max{ğ›¿min, ğ›¾ğ›¿ğ‘˜ }

For the geometric problem we choose ğœŒ0
ğ‘– = 10, ğœŒmax = 1ğ‘’9, ğ›¿0 = 0.5, ğ›¾ = 0.9, ğ›¿min = 0.05, ğœ =
0.8, ğœ = 5. The subproblem (8) is solved with NGOpt with a budget of min{20.000, 1500 + ğ‘˜ Â· 260}
forward-model calls.
For the simple-to-build problem we choose ğœŒ0
ğ‘– = 10, ğœŒmax = 1ğ‘’9, ğ›¿0 = 0.5, ğ›¾ = 0.95, ğ›¿min = 0.05, ğœ =
0.8, ğœ = 5. The subproblem (8) is solved with NGOpt with a budget of min{20.000, 1500 + ğ‘˜ Â· 260}
forward-model calls.
For the MHD-stable problems we choose ğœŒ0
ğ‘– = 10, ğœŒmax = 1ğ‘’8, ğ›¿0 = 0.33, ğ›¾ = 0.95, ğ›¿min = 0.05, ğœ =
0.8, ğœ = 5. The subproblem (8) is solved with NGOpt with a budget of min{20.000, 1500 + ğ‘˜ Â· 300}
forward-model calls.
For all problems, Î˜0 is a rotating ellipse configuration. We optimize up to four poloidal and toroidal
Fourier modes, which results in ğ· = 80 degrees of freedom. During the optimization, we run
VMEC++ at low fidelity.

A.4.2 Additional experimental results

We provide convergence plots for the three problems obtained with ALM-NGOpt. Green curves
represent metrics that are constrained. Red colored metrics are maximized and blue colored metrics
are minimized. Gray curves correspond to metrics that are not part of the optimization problem. The
blue dashed lines indicate lower bounds and the red dashed lines indicate upper bounds. Figure 11
provides plots corresponding to the single-objective problem, while Figure 12 provides a plot for one
instance (ğ´ â‰¤ 8) of the sequence of single-objective problems corresponding to the multi-objective
problem.

17

In Figure 10 we show the initial and final plasma configurations for the different problems.

(a) initial geometric

(b) final geometric

(c) initial simple-to-build

(d) final simple-to-build

(e) initial MHD-stable

(f) final MHD-stable

Figure 10: Initial guesses and final plasma configurations optimized with ALM-NGOpt. We selected
a low aspect ratio configuration from the Pareto Front of solutions for the multi-objective problem.

A.5 Generative modeling details

We use the Random Forest classifier and the GMM implementations from Scikit-learn [65]. We
use the Random walk Metropolis-Hastings algorithm [66] with adaptive proposal distribution [67]
as the MCMC sampler. To monitor the convergence of the MCMC sampler, Figure 13 presents
the log-probability of the posterior distribution evaluated at each sampled point. The rising and
stabilizing log-probability indicates convergence to high-density regions. Algorithm 2 summarizes
the formulation discussed in Section 5.

18

0.891.151.41|B|[T]0.60.81.01.2R [m]âˆ’0.4âˆ’0.20.00.20.4Z [m]'=0:002Â¼Nfp'=0:122Â¼Nfp'=0:252Â¼Nfp'=0:382Â¼Nfp'=0:502Â¼Nfp0.721.602.49|B|[T]0.60.81.01.21.41.6R [m]âˆ’0.20.00.20.40.6Z [m]'=0:002Â¼Nfp'=0:122Â¼Nfp'=0:252Â¼Nfp'=0:382Â¼Nfp'=0:502Â¼Nfp0.641.281.91|B|[T]0.91.01.1R [m]âˆ’0.10.00.10.20.3Z [m]'=0:002Â¼Nfp'=0:122Â¼Nfp'=0:252Â¼Nfp'=0:382Â¼Nfp'=0:502Â¼Nfp1.271.581.90|B|[T]0.80.91.01.1R [m]âˆ’0.2âˆ’0.10.00.10.20.3Z [m]'=0:002Â¼Nfp'=0:122Â¼Nfp'=0:252Â¼Nfp'=0:382Â¼Nfp'=0:502Â¼Nfp0.501.001.50|B|[T]0.951.001.051.10R [m]âˆ’0.10âˆ’0.050.000.050.100.150.20Z [m]'=0:002Â¼Nfp'=0:122Â¼Nfp'=0:252Â¼Nfp'=0:382Â¼Nfp'=0:502Â¼Nfp0.260.340.43|B|[T]0.80.91.01.1R [m]âˆ’0.2âˆ’0.10.00.10.20.30.4Z [m]'=0:002Â¼Nfp'=0:122Â¼Nfp'=0:252Â¼Nfp'=0:382Â¼Nfp'=0:502Â¼Nfp(a) geometric problem.

(b) Simple-to-build problem.

Figure 11: Single-objective problem optimization traces.

Figure 12: Multi-objective problem with ğ´ â‰¤ 8.

(a) geometric problem.

(b) Simple-to-build QI problem.

Figure 13: Trace plot of the log-posterior probability values over MCMC iterations.

19

0200000functioncalls234ËœLâˆ‡B0200000functioncalls0.10.20.3ËœÎ¹0200000functioncalls3.253.503.754.00A0200000functioncalls23(cid:15)max0200000functioncalls0.30.40.5âˆ†âˆ’0.050.000.05functioncalls100101QI0200000functioncallsâˆ’0.3âˆ’0.2WMHDâˆ’0.050.000.05functioncallsâˆ’0.050.000.05hÏ‡âˆ‡ri0200000functioncallsâˆ’0.4âˆ’0.20.0Â¯Î´0250000functioncalls101520ËœLâˆ‡B0250000functioncalls0.00.10.2ËœÎ¹0250000functioncalls91011A0250000functioncalls345(cid:15)max0250000functioncalls0.20.40.60.8âˆ†0250000functioncalls10âˆ’410âˆ’3QI0250000functioncallsâˆ’0.10âˆ’0.05WMHD0250000functioncalls0.60.81.0hÏ‡âˆ‡ri0250000functioncallsâˆ’0.10âˆ’0.050.000.05Â¯Î´0200000functioncalls1020ËœLâˆ‡B0200000functioncalls0.00.10.2ËœÎ¹0200000functioncalls7.510.012.5A0200000functioncalls51015(cid:15)max0200000functioncalls0.250.500.75âˆ†0200000functioncalls10âˆ’310âˆ’2QI0200000functioncalls0.000.05WMHD0200000functioncalls12hÏ‡âˆ‡ri0200000functioncalls0.00.5Â¯Î´01000200030004000Iterationâˆ’400000âˆ’300000âˆ’200000âˆ’1000000Logprobability01000200030004000Iterationâˆ’35000âˆ’30000âˆ’25000âˆ’20000âˆ’15000âˆ’10000âˆ’50000LogprobabilityAlgorithm 2 Generative Inference of Feasible Configurations without Oracle Access
Require: Dataset D = {ğ‘¥1, . . . , ğ‘¥ ğ‘ } âŠ‚ Rğ·, constraint definition
Ensure: Set of configurations {ğ‘¥âˆ—} predicted to lie in the feasible domain

// Dimensionality Reduction:

1: Compute PCA mapping Î¦ : Rğ· â†’ Rğ‘‘, where ğ‘‘ â‰ª ğ·
2: Project dataset to latent space: ğ‘ â† {zğ‘– = Î¦(ğ‘¥ğ‘–)} ğ‘
ğ‘–=1

// Feasibility Classification:

3: Train Random Forest classifiers {ğ¶ğ‘– (z)} ğ‘ğ‘
4: Define soft-feasible region: ËœF â† (cid:209)ğ‘ğ‘
ğ‘–=1

ğ‘–=1 to predict feasibility label ğ‘¦ âˆˆ {0, 1}
{ğ‘(ğ¶ğ‘– (z) = 1) â‰¥ ğœ}, where ğœğ‘– = 0.8 âˆ€ğ‘–

// Density Estimation:

5: Fit Gaussian Mixture Model GMM(z) on data restricted to ËœF

// Bayesian Refinement:

6: Define prior: ğ‘(z) â† GMM(z)
7: Define quasi-likelihood: â„“(z) â† (cid:205)ğ‘ğ‘
8: Compute posterior using MCMC: {zâˆ—} âˆ¼ ğ‘(z | feasible) âˆ â„“(z) Â· ğ‘(z)
9: Inverse transform to original space: ğ‘¥âˆ— â† Î¦âˆ’1(zâˆ—)

ğ‘–=1 log ğ¶ğ‘– (z)

// Oracle Validation:

10: Evaluate ğ‘¥âˆ— using VMEC++ oracle to confirm feasibility
11: return {ğ‘¥âˆ—}

20


